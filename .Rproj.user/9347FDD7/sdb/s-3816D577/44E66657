{
    "contents" : "## Data prep for CRF workshop; also can serve as a usage example for package samcleanR\n\nsetwd(\"C:/Users/Sam/Dropbox/IPT-CBT RCT_Original Excel Data Files_Unshared_Sam copy\")\n\n#install package if necessary using devtools::install_github(\"sbernecker/samcleanR\")\nlibrary(samcleanR)\n\n#get the names of the files that I want to read in\nfilelist <- list.files()[c(-3, -4, -22, -23, -24)]\n#rearrange file list so that they're in chronological order\nfilelist <- c(filelist[2:4], filelist[12:19], filelist[5:11], filelist[1])\n\n# [1] \"Intake.xlsx\" \"Pre-S1.xlsx\" \"S1.xlsx\"\n# [4] \"S2.xlsx\"     \"S3.xlsx\"     \"S4.xlsx\"\n# [7] \"S5.xlsx\"     \"S6.xlsx\"     \"S7.xlsx\"\n# [10] \"S8.xlsx\"     \"S9.xlsx\"     \"S10.xlsx\"\n# [13] \"S11.xlsx\"    \"S12.xlsx\"    \"S13.xlsx\"\n# [16] \"S14.xlsx\"    \"S15.xlsx\"    \"S16.xlsx\"\n# [19] \"extake.xlsx\"\n\n#read in all the files\nIntake <- workbookToDfList(filelist[1])\nPre-S1 <- workbookToDfList(filelist[2])\nS1 <- workbookToDfList(filelist[3])\nS2 <- workbookToDfList(filelist[4])\nS3 <- workbookToDfList(filelist[5])\nS4 <- workbookToDfList(filelist[6])\nS5 <- workbookToDfList(filelist[7])\nS6 <- workbookToDfList(filelist[8])\nS7 <- workbookToDfList(filelist[9])\nS8 <- workbookToDfList(filelist[10])\nS9 <- workbookToDfList(filelist[11])\nS10 <- workbookToDfList(filelist[12])\nS11 <- workbookToDfList(filelist[13])\nS12 <- workbookToDfList(filelist[14])\nS13 <- workbookToDfList(filelist[15])\nS14 <- workbookToDfList(filelist[16])\nS15 <- workbookToDfList(filelist[17])\nS16 <- workbookToDfList(filelist[18])\nextake <- workbookToDfList(filelist[2])\n\n#get scoring info\nlkp <- getLookup(\"C:/Users/Sam/Documents/research/samcleanR/scoring_lookup.xlsx\")\n\n#score the BDI, 6-item HRSD/HAMD, and the SSQ (N and S) ****without any mean substitution**** and write the results to an Excel file\nsubscales <- c(\"BDItotal\", \"SSQNtotal\", \"SSQStotal\",\"HRSD6total\", \"HAMD6total\")\n\nscoredDf <- megaScorer(Intake, Pre-S1, S1, S2, S3, S4, S5, S6, S7, S8, S9, S10, S11, S12, S13, S14, S15, S16, extake, lookupList = lkp, subscales = subscales, writeToExcel = TRUE)\n\n#create a big ol table of missingness and write it to an Excel file\nmegaMissingness(Intake, Pre-S1, S1, S2, S3, S4, S5, S6, S7, S8, S9, S10, S11, S12, S13, S14, S15, S16, extake, lookupList = lkp, subscales = subscales, writeToExcel = TRUE)\n\n#score same as above but with mean substitution for Ss who have more than 20% of items\nsystem.time({meanSubstScoredDf <- megaScorer(Intake, Pre-S1, S1, S2, S3, S4, S5, S6, S7, S8, S9, S10, S11, S12, S13, S14, S15, S16, extake, lookupList = lkp, subscales = subscales, writeToExcel = TRUE, meanSub = TRUE, criterion = 20)})\n",
    "created" : 1433642413374.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "299341052",
    "id" : "44E66657",
    "lastKnownWriteTime" : 1433642582,
    "path" : "~/research/CBT-IPT RCT/usage_example_prep_my_data.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}